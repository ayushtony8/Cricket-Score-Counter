<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cricket Score Counter</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #121212;
            color: #e0e0e0;
        }

        h1 {
            text-align: center;
            color: #00ff95;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 30px;
            border-bottom: 3px solid #00ff95;
            padding-bottom: 10px;
        }

        .score-board {
            background: linear-gradient(145deg, #1e1e1e, #2d2d2d);
            border: none;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .score-board h2 {
            color: #00ff95;
            font-size: 2.5em;
            margin: 0;
            text-align: center;
        }

        .score-board p {
            font-size: 1.2em;
            margin: 10px 0;
            padding: 8px;
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.05);
            color: #e0e0e0;
        }

        .batting-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
            padding: 20px;
            background: #1e1e1e;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        button {
            padding: 12px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: bold;
            text-transform: uppercase;
            color: #121212;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 255, 149, 0.2);
            opacity: 0.9;
        }

        .wicket-btn {
            background-color: #ff4444;
            grid-column: span 3;
        }

        .extras-btn {
            background-color: #00bcd4;
        }

        .player-input {
            background: #1e1e1e;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
        }

        input, select {
            padding: 12px;
            margin: 8px;
            border: 1px solid #333;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
            background-color: #2d2d2d;
            color: #e0e0e0;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #00ff95;
            box-shadow: 0 0 0 2px rgba(0, 255, 149, 0.1);
        }

        .history-section {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .batting-history, .bowling-history {
            background: #1e1e1e;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
        }

        h3 {
            color: #00ff95;
            margin-top: 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #00ff95;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 10px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border: none;
            color: #e0e0e0;
        }

        th {
            background-color: #2d2d2d;
            font-weight: bold;
            color: #00ff95;
        }

        tr:nth-child(even) {
            background-color: #252525;
        }

        tr:hover {
            background-color: #333;
        }

        .bowling-section {
            background: #1e1e1e;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            margin: 20px 0;
        }

        .match-controls {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }

        .match-controls button {
            flex: 1;
            background-color: #00bcd4;
            padding: 15px;
        }

        /* Run buttons specific styling */
        .batting-controls button:not(.wicket-btn):not(.extras-btn) {
            background-color: #00ff95;
            font-size: 1.5em;
        }

        /* Animation for score updates */
        @keyframes highlight {
            0% { background-color: #00ff95; }
            100% { background-color: transparent; }
        }

        .score-update {
            animation: highlight 1s ease;
        }

        /* Target Info Styling */
        #target-info {
            background-color: #2d2d2d;
            color: #00ff95;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            font-size: 1.2em;
            margin-bottom: 15px;
            border: 1px solid #00ff95;
            display: none; /* Initially hidden */
        }

        /* Add animation for target updates */
        @keyframes highlight {
            0% { background-color: #3d3d3d; }
            100% { background-color: #2d2d2d; }
        }

        #target-info.update {
            animation: highlight 0.5s ease;
        }

        /* Placeholder styling */
        input::placeholder {
            color: #888;
        }

        /* Option styling */
        option {
            background-color: #2d2d2d;
            color: #e0e0e0;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .history-section {
                grid-template-columns: 1fr;
            }

            .batting-controls {
                grid-template-columns: repeat(2, 1fr);
            }

            .wicket-btn {
                grid-column: span 2;
            }

            input, select {
                width: calc(100% - 16px);
            }
        }

        .first-innings, .second-innings {
            background: #1e1e1e;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
        }

        .first-innings h3, .second-innings h3 {
            color: #00ff95;
            margin-bottom: 20px;
        }

        .batting-history, .bowling-history {
            margin-bottom: 20px;
        }

        .batting-history h4, .bowling-history h4 {
            color: #00bcd4;
            margin: 10px 0;
            padding-bottom: 5px;
            border-bottom: 1px solid #333;
        }

        .history-section {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .first-innings, .second-innings {
                padding: 15px;
            }
        }

        /* Add styles for the history button */
        #show-history-btn {
            background-color: #2d2d2d;
            color: #00ff95;
            border: 1px solid #00ff95;
        }

        #show-history-btn:hover {
            background-color: #00ff95;
            color: #2d2d2d;
        }

        /* Style for the history section */
        .first-innings {
            background: #1e1e1e;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
        }

        .first-innings h3 {
            color: #00ff95;
            margin-bottom: 20px;
        }

        .history-section {
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        #new-match-btn {
            background-color: #2d2d2d;
            color: #00ff95;
            border: 2px solid #00ff95;
            padding: 12px 24px;
            font-size: 1.1em;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
        }

        #new-match-btn:hover {
            background-color: #00ff95;
            color: #2d2d2d;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <h1>Cricket Score Counter</h1>
    
    <div class="player-input">
        <input type="text" id="striker" placeholder="Striker's Name" required>
        <input type="text" id="non-striker" placeholder="Non-striker's Name" required>
        <input type="number" id="total-overs" placeholder="Number of Overs" required min="1">
        <button onclick="setPlayers()">Start Match</button>
    </div>

    <div class="score-board">
        <div id="target-info" style="display: none;"></div>
        <h2>Score: <span id="total-score">0</span>/<span id="wickets">0</span></h2>
        <p>Overs: <span id="overs">0.0</span></p>
        <p>Current Strike: <span id="current-striker">-</span> (<span id="striker-score">0</span>)</p>
        <p>Non-striker: <span id="current-non-striker">-</span> (<span id="non-striker-score">0</span>)</p>
    </div>

    <div class="bowling-section">
        <div class="bowler-input">
            <select id="bowler-select" onchange="selectExistingBowler()">
                <option value="">Select Previous Bowler</option>
            </select>
            <input type="text" id="bowler-name" placeholder="Current Bowler">
            <button onclick="setBowler()">Set Bowler</button>
        </div>
    </div>

    <div class="batting-controls">
        <button onclick="addRuns(0)">0</button>
        <button onclick="addRuns(1)">1</button>
        <button onclick="addRuns(2)">2</button>
        <button onclick="addRuns(3)">3</button>
        <button onclick="addRuns(4)">4</button>
        <button onclick="addRuns(6)">6</button>
        <button class="extras-btn" onclick="addWide()">Wide</button>
        <button class="extras-btn" onclick="addExtras()">Other Extras</button>
        <button class="wicket-btn" onclick="addWicket()">Wicket</button>
    </div>

    <div class="history-section">
        <div class="batting-history">
            <h3>Batting History</h3>
            <table id="batting-table">
                <thead>
                    <tr>
                        <th>Batsman</th>
                        <th>Runs</th>
                        <th>Balls</th>
                        <th>Status</th>
                        <th>Out By</th>
                    </tr>
                </thead>
                <tbody id="batting-history"></tbody>
            </table>
        </div>

        <div class="bowling-history">
            <h3>Bowling History</h3>
            <table id="bowling-table">
                <thead>
                    <tr>
                        <th>Bowler</th>
                        <th>Overs</th>
                        <th>Runs</th>
                        <th>Wickets</th>
                    </tr>
                </thead>
                <tbody id="bowling-history"></tbody>
            </table>
        </div>
    </div>

    <div class="match-controls">
        <button id="new-match-btn" onclick="confirmNewMatch()">Start New Match</button>
        <button id="new-inning-btn" onclick="startSecondInning()" style="display: none;">Start 2nd Inning</button>
        <button id="show-history-btn" onclick="toggleMatchHistory()" style="display: none;">Show Previous Innings</button>
    </div>

    <div id="history-section" class="history-section" style="display: none;">
        <div class="first-innings">
            <h3>First Innings</h3>
            <div class="batting-history">
                <h4>Batting</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Batsman</th>
                            <th>Runs</th>
                            <th>Balls</th>
                            <th>Status</th>
                            <th>Out By</th>
                        </tr>
                    </thead>
                    <tbody id="first-innings-batting"></tbody>
                </table>
            </div>
            <div class="bowling-history">
                <h4>Bowling</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Bowler</th>
                            <th>Overs</th>
                            <th>Runs</th>
                            <th>Wickets</th>
                        </tr>
                    </thead>
                    <tbody id="first-innings-bowling"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let totalScore = 0;
        let wickets = 0;
        let balls = 0;
        let strikerScore = 0;
        let nonStrikerScore = 0;
        let totalOvers = 0;
        let matchStarted = false;
        let batsmenHistory = {};
        let bowlersHistory = {};
        let currentBowler = '';
        let isSecondInning = false;
        let firstInningScore = 0;
        let firstInningWickets = 0;
        let bowlersList = new Set();
        let firstInningBattingHistory = {};
        let firstInningBowlingHistory = {};
        let secondInningBattingHistory = {};
        let secondInningBowlingHistory = {};

        // Add these functions to handle local storage

        // Function to save match data to local storage
        function saveMatchData() {
            const matchData = {
                // Current match state
                totalScore,
                wickets,
                balls,
                strikerScore,
                nonStrikerScore,
                totalOvers,
                matchStarted,
                batsmenHistory,
                bowlersHistory,
                currentBowler,
                isSecondInning,
                
                // First innings data
                firstInningScore,
                firstInningWickets,
                firstInningBattingHistory,
                firstInningBowlingHistory,
                
                // Current batsmen
                currentStriker: document.getElementById('current-striker').textContent,
                currentNonStriker: document.getElementById('current-non-striker').textContent,
                
                // Button states
                showNewInningBtn: document.getElementById('new-inning-btn').style.display,
                showNewMatchBtn: document.getElementById('new-match-btn').style.display
            };
            
            localStorage.setItem('cricketMatchData', JSON.stringify(matchData));
            localStorage.setItem('lastUpdated', new Date().toISOString());
        }

        // Function to load match data from local storage
        function loadMatchData() {
            const savedData = localStorage.getItem('cricketMatchData');
            if (savedData) {
                const matchData = JSON.parse(savedData);
                
                // Restore match state
                totalScore = matchData.totalScore;
                wickets = matchData.wickets;
                balls = matchData.balls;
                strikerScore = matchData.strikerScore;
                nonStrikerScore = matchData.nonStrikerScore;
                totalOvers = matchData.totalOvers;
                matchStarted = matchData.matchStarted;
                batsmenHistory = matchData.batsmenHistory;
                bowlersHistory = matchData.bowlersHistory;
                currentBowler = matchData.currentBowler;
                isSecondInning = matchData.isSecondInning;
                
                // Restore first innings data
                firstInningScore = matchData.firstInningScore;
                firstInningWickets = matchData.firstInningWickets;
                firstInningBattingHistory = matchData.firstInningBattingHistory;
                firstInningBowlingHistory = matchData.firstInningBowlingHistory;
                
                // Update UI
                document.getElementById('current-striker').textContent = matchData.currentStriker;
                document.getElementById('current-non-striker').textContent = matchData.currentNonStriker;
                document.getElementById('new-inning-btn').style.display = matchData.showNewInningBtn;
                document.getElementById('new-match-btn').style.display = matchData.showNewMatchBtn;
                
                updateScore();
                updateBattingHistory();
                updateBowlingHistory();
                updateBowlerDropdown();
                
                // If it's second innings, update the display accordingly
                if (isSecondInning) {
                    updateDisplayForSecondInnings();
                    updateTargetInfo();
                }
                
                return true;
            }
            return false;
        }

        // Function to clear match data from local storage
        function clearMatchData() {
            localStorage.removeItem('cricketMatchData');
            localStorage.removeItem('lastUpdated');
        }

        function setPlayers() {
            const striker = document.getElementById('striker').value;
            const nonStriker = document.getElementById('non-striker').value;
            const overs = document.getElementById('total-overs').value;
            
            if (!striker || !nonStriker || !overs) {
                alert('Please fill in all fields!');
                return;
            }
            
            if (!isSecondInning) {
                totalOvers = parseInt(overs);
            }
            
            document.getElementById('current-striker').textContent = striker;
            document.getElementById('current-non-striker').textContent = nonStriker;
            
            batsmenHistory[striker] = { runs: 0, balls: 0, status: 'Batting', outBy: '' };
            batsmenHistory[nonStriker] = { runs: 0, balls: 0, status: 'Batting', outBy: '' };
            
            matchStarted = true;
            updateBattingHistory();
            saveMatchData();
        }

        function setBowler() {
            if (!matchStarted) {
                alert('Please start the match first!');
                return;
            }
            
            const bowlerName = document.getElementById('bowler-name').value;
            if (!bowlerName) {
                alert('Please enter bowler name!');
                return;
            }
            
            currentBowler = bowlerName;
            bowlersList.add(bowlerName);
            updateBowlerDropdown();
            
            if (!bowlersHistory[bowlerName]) {
                bowlersHistory[bowlerName] = { overs: 0, runs: 0, wickets: 0, balls: 0 };
            }
            updateBowlingHistory();
        }

        function updateBowlerDropdown() {
            const select = document.getElementById('bowler-select');
            select.innerHTML = '<option value="">Select Previous Bowler</option>';
            bowlersList.forEach(bowler => {
                const option = document.createElement('option');
                option.value = bowler;
                option.textContent = bowler;
                select.appendChild(option);
            });
        }

        function selectExistingBowler() {
            const select = document.getElementById('bowler-select');
            const bowlerName = select.value;
            if (bowlerName) {
                document.getElementById('bowler-name').value = bowlerName;
                setBowler();
            }
        }

        function startSecondInning() {
            firstInningScore = totalScore;
            firstInningWickets = wickets;
            
            // Save first innings histories
            firstInningBattingHistory = {...batsmenHistory};
            firstInningBowlingHistory = {...bowlersHistory};
            
            // Reset for second innings
            totalScore = 0;
            wickets = 0;
            balls = 0;
            strikerScore = 0;
            nonStrikerScore = 0;
            currentBowler = '';
            isSecondInning = true;
            
            // Clear batsmen names and histories
            document.getElementById('current-striker').textContent = '-';
            document.getElementById('current-non-striker').textContent = '-';
            document.getElementById('striker').value = '';
            document.getElementById('non-striker').value = '';
            batsmenHistory = {};
            
            // Clear bowlers for second innings
            bowlersList.clear();
            updateBowlerDropdown();
            
            // Keep the same number of overs
            document.getElementById('total-overs').value = totalOvers;
            document.getElementById('total-overs').disabled = true;
            
            // Show and update target info
            document.getElementById('target-info').style.display = 'block';
            updateTargetInfo();
            
            // Update UI
            updateDisplayForSecondInnings();
            
            // Reset match started flag to require new batsmen
            matchStarted = false;
            
            alert('Please enter new batting pair for second innings');
            saveMatchData();
        }

        function updateDisplayForSecondInnings() {
            // Only update the current innings display
            const historySection = document.querySelector('.history-section');
            historySection.innerHTML = `
                <div class="second-innings">
                    <h3>Current Innings</h3>
                    <div class="batting-history">
                        <h4>Batting</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Batsman</th>
                                    <th>Runs</th>
                                    <th>Balls</th>
                                    <th>Status</th>
                                    <th>Out By</th>
                                </tr>
                            </thead>
                            <tbody id="second-innings-batting"></tbody>
                        </table>
                    </div>
                    <div class="bowling-history">
                        <h4>Bowling</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Bowler</th>
                                    <th>Overs</th>
                                    <th>Runs</th>
                                    <th>Wickets</th>
                                </tr>
                            </thead>
                            <tbody id="second-innings-bowling"></tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function startNewMatch() {
            if (!confirm('Are you sure you want to start a new match? All current match data will be lost.')) {
                return;
            }
            
            // Reset all variables
            totalScore = 0;
            wickets = 0;
            balls = 0;
            strikerScore = 0;
            nonStrikerScore = 0;
            totalOvers = 0;
            matchStarted = false;
            isSecondInning = false;
            currentBowler = '';
            batsmenHistory = {};
            bowlersHistory = {};
            firstInningScore = 0;
            firstInningWickets = 0;
            firstInningBattingHistory = {};
            firstInningBowlingHistory = {};
            bowlersList.clear();
            
            // Clear all inputs
            document.getElementById('striker').value = '';
            document.getElementById('non-striker').value = '';
            document.getElementById('total-overs').value = '';
            document.getElementById('bowler-name').value = '';
            document.getElementById('total-overs').disabled = false;
            
            // Reset display
            document.getElementById('current-striker').textContent = '-';
            document.getElementById('current-non-striker').textContent = '-';
            document.getElementById('striker-score').textContent = '0';
            document.getElementById('non-striker-score').textContent = '0';
            document.getElementById('total-score').textContent = '0';
            document.getElementById('wickets').textContent = '0';
            document.getElementById('overs').textContent = '0.0';
            
            // Hide other control buttons
            document.getElementById('new-inning-btn').style.display = 'none';
            document.getElementById('show-history-btn').style.display = 'none';
            
            // Clear history tables
            document.getElementById('batting-history').innerHTML = '';
            document.getElementById('bowling-history').innerHTML = '';
            
            // Hide and clear target info
            const targetInfo = document.getElementById('target-info');
            if (targetInfo) {
                targetInfo.style.display = 'none';
                targetInfo.innerHTML = '';
            }
            
            // Hide history section
            const historySection = document.getElementById('history-section');
            if (historySection) {
                historySection.style.display = 'none';
            }
            
            // Reset bowler dropdown
            updateBowlerDropdown();
            
            // Clear local storage
            clearMatchData();
        }

        // Add this to handle match completion scenarios
        function handleMatchCompletion(message) {
            alert(message);
            document.getElementById('new-match-btn').style.display = 'block';
            document.getElementById('new-inning-btn').style.display = 'none';
        }

        // Modify the addRuns function to use handleMatchCompletion
        function addRuns(runs) {
            if (!matchStarted) {
                alert('Please set players and overs first!');
                return;
            }

            if (!currentBowler) {
                alert('Please set a bowler first!');
                return;
            }
            
            if (Math.floor(balls/6) >= totalOvers) {
                alert('Match is over!');
                return;
            }

            const striker = document.getElementById('current-striker').textContent;
            batsmenHistory[striker].runs += runs;
            batsmenHistory[striker].balls += 1;
            bowlersHistory[currentBowler].runs += runs;
            bowlersHistory[currentBowler].balls += 1;

            totalScore += runs;
            strikerScore += runs;
            balls++;
            
            updateScore();
            updateBattingHistory();
            updateBowlingHistory();
            updateTargetInfo();
            saveMatchData();
            
            if (runs % 2 === 1) {
                rotateStrike();
            }
            
            if (balls % 6 === 0) {
                rotateStrike();
                promptNewBowler();
            }

            if (isSecondInning && totalScore > firstInningScore) {
                handleMatchCompletion('Match Complete! Second innings team wins!');
                return;
            }
        }

        // Modify promptNewBowler
        function promptNewBowler() {
            if (Math.floor(balls/6) >= totalOvers) {
                if (!isSecondInning) {
                    document.getElementById('new-inning-btn').style.display = 'block';
                    document.getElementById('new-match-btn').style.display = 'none';
                    alert('First innings complete!');
                } else {
                    handleMatchCompletion('Match complete! First innings team wins!');
                }
                return;
            }
            
            currentBowler = '';
            document.getElementById('bowler-name').value = '';
            alert('Over complete! Please set new bowler.');
        }

        function addWide() {
            if (!matchStarted) {
                alert('Please set players and overs first!');
                return;
            }

            if (!currentBowler) {
                alert('Please set a bowler first!');
                return;
            }
            
            totalScore += 1;
            bowlersHistory[currentBowler].runs += 1;
            updateScore();
            updateBowlingHistory();
            updateTargetInfo();
            saveMatchData();
        }

        function addExtras() {
            if (!matchStarted) {
                alert('Please set players and overs first!');
                return;
            }

            if (!currentBowler) {
                alert('Please set a bowler first!');
                return;
            }

            const extras = parseInt(prompt("Enter extras (wides/no-balls/byes/leg-byes):", "1"));
            if (!isNaN(extras)) {
                totalScore += extras;
                bowlersHistory[currentBowler].runs += extras;
                updateScore();
                updateBowlingHistory();
                updateTargetInfo();
                saveMatchData();
            }
        }

        function addWicket() {
            if (!matchStarted || !currentBowler) {
                alert('Please ensure match is started and bowler is set!');
                return;
            }

            if (wickets < 9) {
                const outBatsman = document.getElementById('current-striker').textContent;
                batsmenHistory[outBatsman].status = 'Out';
                batsmenHistory[outBatsman].balls += 1;
                batsmenHistory[outBatsman].outBy = currentBowler; // Add bowler who took the wicket
                
                bowlersHistory[currentBowler].wickets += 1;
                bowlersHistory[currentBowler].balls += 1;
                
                const newBatsman = prompt("Enter new batsman's name:");
                if (newBatsman) {
                    batsmenHistory[newBatsman] = { 
                        runs: 0, 
                        balls: 0, 
                        status: 'Batting',
                        outBy: '' 
                    };
                    document.getElementById('current-striker').textContent = newBatsman;
                    strikerScore = 0;
                }
                
                wickets++;
                balls++;
                updateScore();
                updateBattingHistory();
                updateBowlingHistory();
                updateTargetInfo();
                saveMatchData();
                
                if (balls % 6 === 0) {
                    rotateStrike();
                    promptNewBowler();
                }
            } else {
                wickets++;
                updateScore();
                if (isSecondInning) {
                    handleMatchCompletion('Match Complete! First innings team wins!');
                } else {
                    document.getElementById('new-inning-btn').style.display = 'block';
                    alert('Innings Complete! All Out!');
                }
            }
        }

        function rotateStrike() {
            const tempName = document.getElementById('current-striker').textContent;
            const tempScore = strikerScore;
            
            document.getElementById('current-striker').textContent = document.getElementById('current-non-striker').textContent;
            strikerScore = nonStrikerScore;
            
            document.getElementById('current-non-striker').textContent = tempName;
            nonStrikerScore = tempScore;
            
            updateScore();
        }

        function updateScore() {
            document.getElementById('total-score').textContent = totalScore;
            document.getElementById('wickets').textContent = wickets;
            document.getElementById('overs').textContent = Math.floor(balls/6) + '.' + (balls % 6);
            document.getElementById('striker-score').textContent = strikerScore;
            document.getElementById('non-striker-score').textContent = nonStrikerScore;
            
            // Add animation to score display
            const scoreElement = document.getElementById('total-score').parentElement;
            scoreElement.classList.remove('score-update');
            void scoreElement.offsetWidth; // Trigger reflow
            scoreElement.classList.add('score-update');
        }

        function updateBattingHistory() {
            if (!isSecondInning) {
                // Update first innings batting
                const historyTable = document.getElementById('batting-history');
                updateBattingTable(historyTable, batsmenHistory);
            } else {
                // Update both innings batting
                const firstInningsTable = document.getElementById('first-innings-batting');
                const secondInningsTable = document.getElementById('second-innings-batting');
                updateBattingTable(firstInningsTable, firstInningBattingHistory);
                updateBattingTable(secondInningsTable, batsmenHistory);
            }
        }

        function updateBowlingHistory() {
            if (!isSecondInning) {
                // Update first innings bowling
                const historyTable = document.getElementById('bowling-history');
                updateBowlingTable(historyTable, bowlersHistory);
            } else {
                // Update both innings bowling
                const firstInningsTable = document.getElementById('first-innings-bowling');
                const secondInningsTable = document.getElementById('second-innings-bowling');
                updateBowlingTable(firstInningsTable, firstInningBowlingHistory);
                updateBowlingTable(secondInningsTable, bowlersHistory);
            }
        }

        // Helper functions for updating tables
        function updateBattingTable(table, history) {
            if (!table) return;
            table.innerHTML = '';
            for (const [batsman, stats] of Object.entries(history)) {
                const row = table.insertRow();
                row.insertCell(0).textContent = batsman;
                row.insertCell(1).textContent = stats.runs;
                row.insertCell(2).textContent = stats.balls;
                row.insertCell(3).textContent = stats.status;
                row.insertCell(4).textContent = stats.outBy || '-';
            }
        }

        function updateBowlingTable(table, history) {
            if (!table) return;
            table.innerHTML = '';
            for (const [bowler, stats] of Object.entries(history)) {
                const overs = Math.floor(stats.balls / 6) + '.' + (stats.balls % 6);
                const row = table.insertRow();
                row.insertCell(0).textContent = bowler;
                row.insertCell(1).textContent = overs;
                row.insertCell(2).textContent = stats.runs;
                row.insertCell(3).textContent = stats.wickets;
            }
        }

        // Add function to update target information
        function updateTargetInfo() {
            if (isSecondInning) {
                const targetInfo = document.getElementById('target-info');
                const remainingRuns = (firstInningScore + 1) - totalScore;
                const remainingBalls = (totalOvers * 6) - balls;
                
                if (remainingRuns <= 0) {
                    targetInfo.innerHTML = 'Target Achieved!';
                } else {
                    targetInfo.innerHTML = `Target: ${firstInningScore + 1}<br>
                                          Need ${remainingRuns} runs from ${remainingBalls} balls`;
                }
                targetInfo.style.display = 'block';
            }
        }

        // Add hover effect for buttons
        document.querySelectorAll('button').forEach(button => {
            button.addEventListener('mouseover', function() {
                this.style.transform = 'translateY(-2px)';
            });
            button.addEventListener('mouseout', function() {
                this.style.transform = 'translateY(0)';
            });
        });

        // Add auto-save feature for browser close/refresh
        window.addEventListener('beforeunload', function() {
            saveMatchData();
        });

        // Add auto-load feature when page loads
        window.addEventListener('load', function() {
            const loaded = loadMatchData();
            if (loaded) {
                console.log('Previous match data restored');
            }
        });

        // Add function to check if there's a saved match
        function hasSavedMatch() {
            return localStorage.getItem('cricketMatchData') !== null;
        }

        // Add function to show resume match option
        function showResumeOption() {
            if (hasSavedMatch()) {
                const lastUpdated = new Date(localStorage.getItem('lastUpdated'));
                const resumeOption = confirm(
                    `There's a saved match from ${lastUpdated.toLocaleString()}\n` +
                    'Would you like to resume it?'
                );
                if (resumeOption) {
                    loadMatchData();
                } else {
                    clearMatchData();
                }
            }
        }

        // Call this when page loads
        window.addEventListener('load', showResumeOption);

        // Function to toggle match history visibility
        function toggleMatchHistory() {
            const historySection = document.getElementById('history-section');
            const showHistoryBtn = document.getElementById('show-history-btn');
            
            if (historySection.style.display === 'none') {
                historySection.style.display = 'block';
                showHistoryBtn.textContent = 'Hide Previous Innings';
                updateBattingHistory();
                updateBowlingHistory();
            } else {
                historySection.style.display = 'none';
                showHistoryBtn.textContent = 'Show Previous Innings';
            }
        }

        // Add confirmation before starting new match
        function confirmNewMatch() {
            if (confirm('Are you sure you want to start a new match? All current match data will be lost.')) {
                startNewMatch();
            }
        }
    </script>
</body>
</html>
